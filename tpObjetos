/** First Wollok example */
object rolando {
	
	var nivelHechiceriaBase = 3;
	var nivelLuchaBase = 5;
	var hechizoPreferido =  espectroMalefico;
	var fuerzaOscura = 5;
	var artefactos = [espadaDelDestino,collarDivino,mascaraOscura,armadura,espejoFantastico];
			
	method getFuerzaOscura() = fuerzaOscura;
	method getArtefactos() = artefactos;
	method getHechizo() = hechizoPreferido;	
	
	method nivelHechiceria() = (nivelHechiceriaBase * hechizoPreferido.poderHechizo()) + fuerzaOscura;
	method eclipse(){ fuerzaOscura = fuerzaOscura * 2;	}	
	
	method nuevoHechizoPreferido(nuevoHechizo) { hechizoPreferido = nuevoHechizo};
	
	method cambiarNivelLuchaBase(nivel) { nivelLuchaBase = nivel};
	
	method agregarArtefacto(artefacto) { artefactos.add(artefacto)};
	
	method removerArtefacto(artefacto) { artefactos.remove(artefacto)};
	
	method nivelLucha(){
		return artefactos.sum({artefacto => artefacto.unidadesDeLucha()})
	}
	
	
}

// Hechizos
object espectroMalefico {	
	var nombre = "Espectro malÃ©fico";
	
	method nuevoNombre(nuevoNombre) { nombre = nuevoNombre};
	
	method poderHechizo() = nombre.size();	
	
	method esPoderoso() = return self.poderHechizo() > 15;
}

object hechizoBasico {	
	method poderHechizo() = 10;	
	method esPoderoso() = return self.poderHechizo() > 15;		
}

//Artefactos
object espadaDelDestino{
	
	method unidadesDeLucha() = 3;
}
object collarDivino{
	method unidadesDeLucha(unasPerlas) = unasPerlas;
}
object mascaraOscura{
	method unidadesDeLucha() =  (rolando.getFuerzaOscura()/2).max(4);
}
object armadura{
	var refuerzo = cotaDeMalla;
	method unidadesDeLucha() = refuerzo.unidadesDeLucha() + 2;
}
object espejoFantastico{
	method unidadesDeLucha(){
		if(rolando.getArtefactos().size() > 0){
		  return rolando.getArtefactos().max({artefacto => artefacto.unidadesDeLucha()});
		}
		else{
		  return 0;
		}			
	}
}
//Refuerzos armadura
object cotaDeMalla{
	method unidadesDeLucha() =  1;
}
object bendicion{
	method unidadesDeLucha() =  rolando.nivelHechiceria();
}
object hechizo{
	method unidadesDeLucha(unHechizo) =  unHechizo.poderHechizo();
}
object ninguno{ //es realmente necesario este?
	method unidadesDeLucha() =  0;
}
//Libros de hechizos
object libroDeHechizos{ //es realmente necesario este?
	var hechizos =  [hechizoBasico,espectroMalefico,espectroMalefico];
    method poderLucha() = hechizos.sum({hechizo => hechizo. esPoderoso()})	
}
